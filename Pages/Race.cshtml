@page
@using Microsoft.Extensions.Caching.Memory
@using Singularity.Models
@using Singularity.Pages.AboutUs;

@inject IMemoryCache _cache

@model IndexModel

@section Scripts {
    <script>
        var requiresData = true;
    </script>
}

@if (Model.RaceViewModel != null)
{
    <div id="racecontent">
    <div class="race-wrapper">
        <div class="title-bar-main">
            <div class="title-main">
                <h2 class="title">Race to Realm 2nd</h2>
            </div>
            <div class="raidracemenu">
                <select id="raid-dropdown" class="raid-dropdown form-control-sm form-select"
                    aria-label="Select Class..." name="class" onchange="onRaidChange(value)">
                    @foreach (var raid in Model.RaceViewModel.Raids)
                        {
                            <option value="@raid.Item1">@raid.Item2</option>
                        }
                    </select>
                </div>
            </div>
            <div id="race-div" class="race-div">
                <div id="race-over-all" class="raceoveralltable">
                    @foreach (var team in Model.RaceViewModel.RealmRace.RankingViewModels)
                    {
                        <div id="guild-info-@team.TeamName" class="guildinfo">
                            <table id="guild-info-table-@team.TeamName" class="guildinfotable">
                                <tbody>
                                    <tr>
                                        <td class="guildinfotablerank">@team.Rank</td>
                                        <td class="faction-cell-@team.Faction"></td>
                                        <td class="guildinfotable">@team.TeamName</td>
                                        <td class="guildinfotabledata">@team.Progress</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    }
                </div>
            </div>
        </div>
        <div id="boss-tables-id" class="boss-tables-class">
            @foreach (var boss in Model.RaceViewModel.BossRace.BossViewModels)
            {
                <div class="race-wrapper boss" id="boss-@boss.NameSlug">
                    <div id="boss-name-@boss.NameSlug" class="title-bar-race">
                        <h2 class="team">@boss.Name</h2>
                    </div>
                    <div class="bossoveralltable">
                        @foreach (var team in boss.RankingViewModels) 
                        {
                            <div class="guildinfo-2">
                                <table id="boss-table-@boss.NameSlug" class="guildinfoboss">
                                    <tbody>
                                        <tr>
                                            <td class="bossinfotablerank">@team.Rank</td>
                                            <td class="faction-cell-@team.Faction"></td>
                                            <td class="bossinfotablename">@team.TeamName</td>
                                            <td class="bossinfotablebestpull">@team.Progress</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        }
                        
                        <div class="boss-image">
                            <img src="@boss.ImageUrl">
                        </div>
                    </div>
                    <div class="wrapper-footer"></div>
                </div>
            }
        </div>
    </div>
}
else
{
    @Html.Partial("_DataLoading")
}
